<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATSOGO Admin Signup</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Define CSS variables for colors - consistent with dashboard */
        :root {
            /* Dark mode default */
            --bg-primary: #1A232F; /* Deeper, richer charcoal-blue */
            --bg-secondary: #2C3E50; /* Slightly lighter for cards/forms */
            --bg-tertiary: #34495E; /* Medium Dark Blue-Gray for input backgrounds/hover */
            --text-primary: #FDFCEE; /* Very subtle warm off-white/cream */
            --text-secondary: #C0C7D0; /* Slightly warmer light gray */
            --border-color: #4A5568; /* Border color */

            /* Accent Colors (yellow/gold themed) - consistent with dashboard */
            --yellow-light-accent: #FCD34D; /* Lighter yellow for accents */
            --yellow-main-accent: #FBBF24; /* Primary golden yellow */
            --yellow-dark-accent: #D97706; /* Deeper orange-gold */
            --yellow-darker-accent: #B45309; /* Richer, darker orange-gold */

            /* Mapping to original indigo variables for consistency in usage */
            --indigo-400: var(--yellow-light-accent);
            --indigo-500: var(--yellow-main-accent);
            --indigo-600: var(--yellow-dark-accent);
            --indigo-700: var(--yellow-darker-accent);

            --white: #ffffff;
            --red-500: #EF4444; /* For error messages */
            --emerald-500: #10B981; /* For success messages */

            /* Password strength colors */
            --strength-weak: #EF4444; /* Red */
            --strength-medium: #FACC15; /* Yellow */
            --strength-strong: #10B981; /* Green */
        }

        /* Light mode overrides - consistent with dashboard */
        body.light-mode {
            --bg-primary: #F5F7FA; /* Very light, cool off-white */
            --bg-secondary: #FFFFFF; /* White background for cards/forms */
            --bg-tertiary: #F3F4F6; /* Light gray for input backgrounds/hover */
            --text-primary: #2D3748; /* Dark Blue-Gray text */
            --text-secondary: #718096; /* Medium Gray text */
            --border-color: #E2E8F0; /* Light border color */

            /* Accent Colors (yellow/gold themed for light mode) */
            --yellow-light-accent: #FBBF24; /* Primary golden yellow */
            --yellow-main-accent: #D97706; /* Deeper orange-gold */
            --yellow-dark-accent: #B45309; /* Darker, richer orange-gold */
            --yellow-darker-accent: #92400E; /* Even darker */

            /* Mapping to original indigo variables for consistency in usage */
            --indigo-400: var(--yellow-light-accent);
            --indigo-500: var(--yellow-main-accent);
            --indigo-600: var(--yellow-dark-accent);
            --indigo-700: var(--yellow-darker-accent);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth theme transition */
            margin: 0;
            display: flex;
            flex-direction: column; /* Allow content to stack vertically */
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem; /* p-4 */
            box-sizing: border-box; /* Ensure padding doesn't cause overflow */
        }

        .signup-container { /* Renamed from .login-container for clarity */
            background-color: var(--bg-secondary);
            border-radius: 0.75rem; /* rounded-lg */
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.2), 0 4px 8px -2px rgba(0, 0, 0, 0.1); /* shadow-xl */
            padding: 2rem; /* p-8 */
            width: 100%;
            max-width: 448px; /* max-w-md */
            box-sizing: border-box; /* Ensure padding doesn't cause overflow */
            transition: all 0.2s ease; /* Keep transition for other effects if any, but remove transform/shadow on hover */
            position: relative; /* Needed for feedback message positioning */
        }

        .signup-header { /* Renamed from .login-header for clarity */
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem; /* mb-6 */
            padding-bottom: 0.75rem; /* Added padding for visual separation */
            border-bottom: 1px solid var(--border-color); /* Subtle line below header */
        }

        .signup-title { /* Renamed from .login-title for clarity */
            font-size: 1.875rem; /* text-3xl */
            font-weight: 700; /* font-bold */
            color: var(--indigo-400); /* text-indigo-400 */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1); /* Subtle shadow */
        }

        .theme-toggle-btn {
            color: var(--text-secondary); /* text-[var(--text-secondary)] */
            background: none;
            border: none;
            cursor: pointer;
            outline: none;
            padding: 0.25rem; /* Small padding for click area */
            transition: color 0.2s ease; /* transition-colors duration-200 */
        }
        .theme-toggle-btn:hover {
            color: var(--text-primary); /* hover:text-[var(--text-primary)] */
        }
        .theme-toggle-btn .lucide {
            width: 1.5rem; /* w-6 */
            height: 1.5rem; /* h-6 */
        }

        .form-group {
            margin-bottom: 0.25rem; /* Further minimized space */
            position: relative; /* For icon positioning */
            /* New: Negative margins to make inputs "extend" visually */
            margin-left: -2rem; /* Pulls left edge of form-group out by 2rem */
            margin-right: -2rem; /* Pulls right edge of form-group out by 2rem */
            padding: 0 2rem; /* Add back padding inside form-group for label and error messages */
        }
        /* Specific margin for the password group to minimize space with confirm password */
        #password-form-group {
            margin-bottom: 0;
        }

        /* Adjust margin for the last form-group before terms, if it's not the password group */
        .form-group:last-of-type {
            margin-bottom: 0.75rem; /* Slightly more space for the last field before terms */
        }


        .form-label {
            display: block;
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            color: var(--text-secondary); /* text-[var(--text-secondary)] */
            margin-bottom: 0.5rem; /* mb-2 */
            padding-left: 0; /* Reset padding from form-group if inherited */
            padding-right: 0; /* Reset padding from form-group if inherited */
        }

        .input-wrapper { /* New wrapper for input and its internal icons/buttons */
            position: relative;
            display: flex; /* To contain input and clear button */
            align-items: center; /* Vertically align items */
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem; /* py-2 */
            padding-left: 2.5rem; /* Space for icon */
            border-radius: 0.5rem; /* rounded-lg */
            background-color: var(--bg-tertiary); /* bg-[var(--bg-tertiary)] */
            color: var(--text-primary); /* text-[var(--text-primary)] */
            outline: none;
            transition: all 0.2s ease; /* transition-colors duration-200 */
            border: 1px solid transparent; /* To prevent layout shift on focus */
            box-sizing: border-box; /* Include padding in width calculation */
        }
        /* Specific padding for password input to accommodate eye icon */
        #password.form-input, #confirm_password.form-input {
            padding-right: 2.5rem; /* Space for eye icon */
        }

        .form-input::placeholder {
            color: var(--text-secondary); /* placeholder-[var(--text-secondary)] */
            opacity: 0.7; /* Make placeholder a bit lighter */
        }
        .form-input:focus {
            border-color: var(--indigo-500); /* focus:ring-2 focus:ring-indigo-500 */
            box-shadow: 0 0 0 2px var(--indigo-500);
        }
        .form-input.invalid {
            border-color: var(--red-500);
            box-shadow: 0 0 0 2px var(--red-500);
        }

        .input-icon {
            position: absolute;
            left: 0.75rem; /* Position icon inside input field */
            top: 50%; /* Center vertically within input-wrapper */
            transform: translateY(-50%);
            color: var(--text-secondary);
            width: 1.25rem; /* w-5 */
            height: 1.25rem; /* h-5 */
            pointer-events: none; /* Allow clicks to pass through to input */
            z-index: 1; /* Ensure icon is above input text */
        }

        .password-toggle-btn, .clear-input-btn {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            outline: none;
            color: var(--text-secondary);
            padding: 0.25rem;
            transition: color 0.2s ease;
            z-index: 2; /* Ensure toggle button is above input text */
        }
        .password-toggle-btn:hover, .clear-input-btn:hover {
            color: var(--text-primary);
        }
        .password-toggle-btn .lucide, .clear-input-btn .lucide {
            width: 1.25rem; /* w-5 */
            height: 1.25rem; /* h-5 */
        }
        .clear-input-btn {
            display: none; /* Hidden by default */
        }

        .btn-primary {
            width: calc(100% - 4rem); /* 100% of container width minus 2x padding */
            margin-left: 2rem; /* Align with new form-group padding */
            margin-right: 2rem; /* Align with new form-group padding */
            background-color: var(--indigo-600); /* bg-indigo-600 */
            color: var(--white); /* text-white */
            font-weight: 700; /* font-bold */
            padding: 0.75rem 1rem; /* py-3 px-4 */
            border-radius: 0.5rem; /* rounded-lg */
            outline: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease; /* transition-all duration-200 */
            box-shadow: 0 4px 10px -2px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.08); /* shadow-md */
            display: flex; /* For centering content and spinner */
            align-items: center;
            justify-content: center;
            gap: 0.5rem; /* Space between text and spinner */
        }
        .btn-primary:hover:not(:disabled) {
            background-color: var(--indigo-700); /* hover:bg-indigo-700 */
            transform: translateY(-2px);
            box-shadow: 0 6px 12px -3px rgba(0, 0, 0, 0.3);
        }
        .btn-primary:focus {
            box-shadow: 0 0 0 3px var(--indigo-500), 0 0 0 6px rgba(var(--indigo-500-rgb), 0.3); /* focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-[var(--bg-secondary)] */
        }
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: var(--indigo-600); /* Keep original color but with opacity */
            transform: none;
            box-shadow: none;
        }

        .loading-spinner {
            animation: spin 1s linear infinite;
            height: 1.25rem; /* h-5 */
            width: 1.25rem; /* w-5 */
            color: var(--white);
            display: none; /* hidden by default */
        }
        .loading-spinner.show {
            display: inline-block; /* Show when active */
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .login-text { /* Renamed from .signup-text for clarity */
            text-align: center;
            font-size: 0.875rem; /* text-sm */
            color: var(--text-secondary); /* text-[var(--text-secondary)] */
            margin-top: 1.5rem; /* mt-6 */
        }

        .login-link { /* Renamed from .signup-link for clarity */
            color: var(--indigo-400); /* text-indigo-400 */
            text-decoration: none;
            transition: color 0.2s ease; /* transition-colors duration-200 */
        }
        .login-link:hover {
            color: var(--indigo-300); /* hover:text-indigo-300 */
            text-decoration: underline;
        }

        .error-message {
            color: var(--red-500);
            font-size: 0.75rem;
            margin-top: 0.25rem;
            min-height: 1rem; /* Prevent layout shift */
            padding-left: 2rem; /* Align with input content */
            padding-right: 2rem; /* Align with input content */
        }

        .password-strength-indicator {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            text-align: right;
            min-height: 1rem; /* Prevent layout shift */
            padding-right: 0.5rem; /* Adjusted for alignment within the form-group */
        }
        .strength-weak { color: var(--strength-weak); }
        .strength-medium { color: var(--strength-medium); }
        .strength-strong { color: var(--strength-strong); }

        /* Styling for the "Powered by ATSOGO" footer */
        .powered-by-atsogo {
            margin-top: 2.5rem; /* Increased margin for better separation */
            font-size: 0.875rem; /* Slightly larger font size */
            color: var(--text-secondary); /* More prominent color */
            text-align: center;
            font-weight: 500; /* Medium font weight */
            letter-spacing: 0.025em; /* Small letter spacing for style */
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.05); /* Subtle text shadow */
            transition: color 0.3s ease; /* Smooth transition for theme change */
            display: flex; /* Enable flexbox for icon and text alignment */
            align-items: center; /* Vertically align items */
            justify-content: center; /* Center horizontally */
            gap: 0.5rem; /* Space between icon and text */
        }
        .powered-by-atsogo .lucide {
            width: 1rem; /* Adjust icon size */
            height: 1rem;
            color: var(--indigo-500); /* Color the icon with an accent color */
            flex-shrink: 0; /* Prevent icon from shrinking */
        }
        /* Light mode specific adjustment for the powered by text */
        body.light-mode .powered-by-atsogo {
            color: var(--text-secondary); /* Ensure it's visible in light mode too */
        }

        /* Terms and Conditions checkbox group */
        .terms-checkbox-group {
            display: flex;
            align-items: flex-start; /* Align checkbox and text at the top */
            margin-top: 0.75rem; /* Adjusted to be closer to the last field */
            margin-bottom: 1.5rem;
            padding: 0 2rem; /* Match form-group padding */
        }
        .terms-checkbox-input {
            margin-top: 0.25rem; /* Align checkbox with the first line of text */
            flex-shrink: 0; /* Prevent checkbox from shrinking */
            height: 1rem; /* h-4 */
            width: 1rem; /* w-4 */
            color: var(--indigo-600); /* text-indigo-600 */
            border-radius: 0.25rem; /* rounded */
            border: 1px solid var(--border-color); /* border-gray-300 */
            background-color: var(--bg-tertiary); /* bg-[var(--bg-tertiary)] */
            cursor: pointer;
            transition: all 0.2s ease;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            position: relative;
            display: inline-block;
            vertical-align: middle;
        }
        .terms-checkbox-input:checked {
            background-color: var(--indigo-600);
            border-color: var(--indigo-600);
        }
        .terms-checkbox-input:checked::before {
            content: '';
            display: block;
            width: 0.5rem; /* checkmark width */
            height: 0.8rem; /* checkmark height */
            border: solid var(--white);
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
            position: absolute;
            top: 0px; /* Adjusted for better vertical centering */
            left: 4px; /* Adjusted for better horizontal centering */
        }
        .terms-checkbox-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--indigo-500); /* focus:ring-indigo-500 */
        }
        .terms-label {
            margin-left: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.4; /* Improve readability for multi-line text */
        }
        .terms-link {
            color: var(--indigo-400);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        .terms-link:hover {
            color: var(--indigo-300);
            text-decoration: underline;
        }
        .terms-error-message {
            color: var(--red-500);
            font-size: 0.75rem;
            margin-top: 0.25rem;
            min-height: 1rem;
            padding-left: 2rem; /* Align with input content */
            padding-right: 2rem; /* Align with input content */
        }


        /* Responsive adjustments */
        @media (max-width: 640px) {
            .signup-container {
                padding: 1.5rem; /* Adjust padding for smaller screens */
            }
            .signup-title {
                font-size: 1.5rem; /* Smaller title on mobile */
            }
            .form-group {
                margin-left: -1.5rem; /* Adjust negative margin for smaller screens */
                margin-right: -1.5rem;
                padding: 0 1.5rem;
            }
            /* Adjust icon positions within the new input-wrapper */
            .input-icon {
                left: 0.75rem; /* Relative to input-wrapper */
            }
            .password-toggle-btn, .clear-input-btn {
                right: 0.75rem; /* Relative to input-wrapper */
            }
            .btn-primary {
                width: calc(100% - 3rem); /* Adjust width based on new form-group padding */
                margin-left: 1.5rem;
                margin-right: 1.5rem;
            }
            .error-message {
                padding-left: 1.5rem; /* Adjust padding for error messages */
                padding-right: 1.5rem;
            }
            .powered-by-atsogo {
                margin-top: 2rem; /* Slightly less margin on mobile */
                font-size: 0.8rem; /* Slightly smaller font on mobile */
            }
            .terms-checkbox-group {
                padding: 0 1.5rem; /* Adjust padding for mobile */
            }
            .terms-error-message {
                padding-left: 1.5rem; /* Adjust padding for mobile */
                padding-right: 1.5rem; /* Adjust padding for mobile */
            }
        }
    </style>
</head>
<body id="theme-body">

    <div class="signup-container">
        <div class="signup-header">
            <h2 class="signup-title">ATSOGO Admin Sign Up</h2>
            <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle theme">
                <i data-lucide="moon" id="theme-icon"></i>
            </button>
        </div>

        <form id="signup-form" aria-label="Sign Up Form">
            <div class="form-group">
                <label for="name" class="form-label">Full Name<span style="color:var(--red-500);" aria-hidden="true">*</span></label>
                <div class="input-wrapper">
                    <i data-lucide="user" class="input-icon" aria-hidden="true"></i>
                    <input type="text" id="name" name="name" class="form-input" placeholder="John Doe" required aria-describedby="name-error" aria-invalid="false">
                </div>
                <div class="error-message" id="name-error" role="alert" aria-live="polite"></div>
            </div>
            <div class="form-group">
                <label for="email" class="form-label">Email Address<span style="color:var(--red-500);" aria-hidden="true">*</span></label>
                <div class="input-wrapper">
                    <i data-lucide="mail" class="input-icon" aria-hidden="true"></i>
                    <input type="email" id="email" name="email" class="form-input" placeholder="your@example.com" required aria-describedby="email-error" aria-invalid="false">
                    <button type="button" class="clear-input-btn" id="clear-email-btn" aria-label="Clear email input">
                        <i data-lucide="x-circle"></i>
                    </button>
                </div>
                <div class="error-message" id="email-error" role="alert" aria-live="polite"></div>
            </div>
            <div class="form-group" id="password-form-group">
                <label for="password" class="form-label">Password<span style="color:var(--red-500);" aria-hidden="true">*</span></label>
                <div class="input-wrapper">
                    <i data-lucide="lock" class="input-icon" aria-hidden="true"></i>
                    <input type="password" id="password" name="password" class="form-input" placeholder="••••••••" required aria-describedby="password-error" aria-invalid="false">
                    <button type="button" id="password-toggle" class="password-toggle-btn" aria-label="Show password">
                        <i data-lucide="eye" id="password-toggle-icon"></i>
                    </button>
                </div>
                <div class="error-message" id="password-error" role="alert" aria-live="polite"></div>
            </div>
            <div class="form-group">
                <label for="confirm_password" class="form-label">Confirm Password<span style="color:var(--red-500);" aria-hidden="true">*</span></label>
                <div class="input-wrapper">
                    <i data-lucide="lock" class="input-icon" aria-hidden="true"></i>
                    <input type="password" id="confirm_password" name="confirm_password" class="form-input" placeholder="••••••••" required aria-describedby="confirm-password-error" aria-invalid="false">
                    <button type="button" id="confirm-password-toggle" class="password-toggle-btn" aria-label="Show password">
                        <i data-lucide="eye" id="confirm-password-toggle-icon"></i>
                    </button>
                </div>
                <div class="error-message" id="confirm-password-error" role="alert" aria-live="polite"></div>
            </div>

            <div class="terms-checkbox-group">
                <input type="checkbox" id="terms_agree" name="terms_agree" class="terms-checkbox-input" aria-label="Agree to terms and privacy policy">
                <label for="terms_agree" class="terms-label">
                    I agree to the <a href="#terms-of-service" class="terms-link" target="_blank" rel="noopener noreferrer">Terms of Service</a> and <a href="#privacy-policy" class="terms-link" target="_blank" rel="noopener noreferrer">Privacy Policy</a>.
                </label>
            </div>
            <div class="terms-error-message" id="terms-error" role="alert" aria-live="polite"></div>


            <button type="submit" class="btn-primary" id="signup-button">
                <span id="signup-button-text">Sign Up</span>
                <svg id="signup-spinner" class="loading-spinner" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </button>
        </form>

        <p class="login-text">
            Already have an admin account?
            <a href="atsogo-admin-login.html" class="login-link">Login</a>
        </p>

        <p class="powered-by-atsogo">
            <i data-lucide="gem" aria-hidden="true"></i>
            <span>Powered by ATSOGO</span>
        </p>
    </div>

    <!-- Feedback Message Container (for overall success/error) -->
    <div id="feedback-message" class="feedback-message" role="status" aria-live="polite">
        <span id="feedback-icon"></span>
        <span id="feedback-text"></span>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        const themeBody = document.getElementById('theme-body');
        const signupForm = document.getElementById('signup-form');

        const nameInput = document.getElementById('name');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirm_password');

        const nameError = document.getElementById('name-error');
        const emailError = document.getElementById('email-error');
        const passwordError = document.getElementById('password-error');
        const confirmPasswordError = document.getElementById('confirm-password-error');

        const clearEmailBtn = document.getElementById('clear-email-btn');

        const passwordToggleBtn = document.getElementById('password-toggle');
        const passwordToggleIcon = document.getElementById('password-toggle-icon');
        const confirmPasswordToggleBtn = document.getElementById('confirm-password-toggle');
        const confirmPasswordToggleIcon = document.getElementById('confirm-password-toggle-icon');

        const termsAgreeCheckbox = document.getElementById('terms_agree');
        const termsError = document.getElementById('terms-error');

        const signupButton = document.getElementById('signup-button');
        const signupButtonText = document.getElementById('signup-button-text');
        const signupSpinner = document.getElementById('signup-spinner');

        // Feedback message elements (for overall success/error)
        const feedbackMessage = document.getElementById('feedback-message');
        const feedbackIcon = document.getElementById('feedback-icon');
        const feedbackText = document.getElementById('feedback-text');


        // --- Utility Functions ---
        function showFeedback(message, type = 'success', targetElement = feedbackMessage, targetIcon = feedbackIcon, targetText = feedbackText) {
            targetText.textContent = message;
            targetElement.classList.remove('success', 'error');
            targetElement.classList.add(type);
            targetIcon.innerHTML = `<i data-lucide="${type === 'success' ? 'check-circle' : 'x-circle'}"></i>`;
            lucide.createIcons(); // Re-render icon

            targetElement.classList.add('show');

            setTimeout(() => {
                targetElement.classList.remove('show');
            }, 3000); // Hide after 3 seconds
        }

        function validateInput(inputElement, errorMessageElement) {
            if (inputElement.hasAttribute('required') && inputElement.value.trim() === '') {
                inputElement.classList.add('invalid');
                errorMessageElement.textContent = 'This field is required.';
                inputElement.setAttribute('aria-invalid', 'true');
                return false;
            } else if (inputElement.type === 'email' && !/\S+@\S+\.\S+/.test(inputElement.value)) {
                inputElement.classList.add('invalid');
                errorMessageElement.textContent = 'Please enter a valid email address.';
                inputElement.setAttribute('aria-invalid', 'true');
                return false;
            } else {
                inputElement.classList.remove('invalid');
                errorMessageElement.textContent = '';
                inputElement.setAttribute('aria-invalid', 'false');
                return true;
            }
        }

        function clearValidation(inputElement, errorMessageElement) {
            inputElement.classList.remove('invalid');
            errorMessageElement.textContent = '';
            inputElement.setAttribute('aria-invalid', 'false');
        }

        function togglePasswordVisibility(inputElement, iconElement, buttonElement) {
            const type = inputElement.getAttribute('type') === 'password' ? 'text' : 'password';
            inputElement.setAttribute('type', type);
            iconElement.setAttribute('data-lucide', type === 'password' ? 'eye' : 'eye-off');
            buttonElement.setAttribute('aria-label', type === 'password' ? 'Show password' : 'Hide password');
            lucide.createIcons();
        }

        // --- Theme management functions ---
        function setTheme(mode) {
            if (mode === 'light') {
                themeBody.classList.add('light-mode');
            } else {
                themeBody.classList.remove('light-mode');
            }
            themeIcon.setAttribute('data-lucide', 'moon');
            lucide.createIcons();
        }

        // Toggle theme manually via button
        themeToggleBtn.addEventListener('click', () => {
            if (themeBody.classList.contains('light-mode')) {
                setTheme('dark');
                localStorage.setItem('theme', 'dark');
            } else {
                setTheme('light');
                localStorage.setItem('theme', 'light');
            }
        });

        // Listen for system theme changes
        const prefersLightScheme = window.matchMedia('(prefers-color-scheme: light)');

        function handleSystemThemeChange(e) {
            if (!localStorage.getItem('theme')) {
                setTheme(e.matches ? 'light' : 'dark');
            }
        }

        prefersLightScheme.addEventListener('change', handleSystemThemeChange);

        // Set initial theme and autofocus on load
        window.onload = () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                setTheme(savedTheme);
            } else {
                setTheme(prefersLightScheme.matches ? 'light' : 'dark');
            }
            nameInput.focus(); // Autofocus on the first input field
        };

        // --- Clear Input Button Logic ---
        nameInput.addEventListener('input', () => {
            // No clear button for name input, just clear validation
            clearValidation(nameInput, nameError);
        });

        emailInput.addEventListener('input', () => {
            if (emailInput.value.length > 0) {
                clearEmailBtn.style.display = 'block';
            } else {
                clearEmailBtn.style.display = 'none';
            }
            clearValidation(emailInput, emailError); // Clear validation on input
        });
        clearEmailBtn.addEventListener('click', () => {
            emailInput.value = '';
            clearEmailBtn.style.display = 'none';
            emailInput.focus();
            clearValidation(emailInput, emailError);
        });


        // Password visibility toggle
        passwordToggleBtn.addEventListener('click', () => {
            togglePasswordVisibility(passwordInput, passwordToggleIcon, passwordToggleBtn);
        });
        confirmPasswordToggleBtn.addEventListener('click', () => {
            togglePasswordVisibility(confirmPasswordInput, confirmPasswordToggleIcon, confirmPasswordToggleBtn);
        });

        // Event listeners for input validation on blur and input
        nameInput.addEventListener('blur', () => validateInput(nameInput, nameError));
        emailInput.addEventListener('blur', () => validateInput(emailInput, emailError));

        passwordInput.addEventListener('blur', () => {
            validateInput(passwordInput, passwordError);
            // Also validate confirm password if password changes
            if (confirmPasswordInput.value.length > 0) {
                validateInput(confirmPasswordInput, confirmPasswordError);
            }
        });
        passwordInput.addEventListener('input', () => {
            clearValidation(passwordInput, passwordError);
            // Also validate confirm password if password changes
            if (confirmPasswordInput.value.length > 0) {
                validateInput(confirmPasswordInput, confirmPasswordError);
            }
        });

        confirmPasswordInput.addEventListener('blur', () => validateInput(confirmPasswordInput, confirmPasswordError));
        confirmPasswordInput.addEventListener('input', () => clearValidation(confirmPasswordInput, confirmPasswordError));

        // Terms and Conditions checkbox validation
        termsAgreeCheckbox.addEventListener('change', () => {
            if (termsAgreeCheckbox.checked) {
                termsError.textContent = '';
            }
        });


        // Form submission handling
        signupForm.addEventListener('submit', (e) => {
            e.preventDefault();

            // Validate all fields on submit
            const isNameValid = validateInput(nameInput, nameError);
            const isEmailValid = validateInput(emailInput, emailError);
            const isPasswordValid = validateInput(passwordInput, passwordError);
            const isConfirmPasswordValid = validateInput(confirmPasswordInput, confirmPasswordError);

            let allValid = isNameValid && isEmailValid && isPasswordValid && isConfirmPasswordValid;

            // Specific password validation rules
            const password = passwordInput.value;
            if (password.length > 0) { // Only validate if not empty (handled by validateInput)
                if (password.length < 8) {
                    passwordInput.classList.add('invalid');
                    passwordError.textContent = 'Password must be at least 8 characters.';
                    passwordInput.setAttribute('aria-invalid', 'true');
                    allValid = false;
                } else if (!/[A-Z]/.test(password)) {
                    passwordInput.classList.add('invalid');
                    passwordError.textContent = 'Password needs an uppercase letter.';
                    passwordInput.setAttribute('aria-invalid', 'true');
                    allValid = false;
                } else if (!/[a-z]/.test(password)) {
                    passwordInput.classList.add('invalid');
                    passwordError.textContent = 'Password needs a lowercase letter.';
                    passwordInput.setAttribute('aria-invalid', 'true');
                    allValid = false;
                } else if (!/[0-9]/.test(password)) {
                    passwordInput.classList.add('invalid');
                    passwordError.textContent = 'Password needs a number.';
                    passwordInput.setAttribute('aria-invalid', 'true');
                    allValid = false;
                } else if (!/[^A-Za-z0-9]/.test(password)) {
                    passwordInput.classList.add('invalid');
                    passwordError.textContent = 'Password needs a special character.';
                    passwordInput.setAttribute('aria-invalid', 'true');
                    allValid = false;
                } else {
                    clearValidation(passwordInput, passwordError);
                }
            }


            if (passwordInput.value !== confirmPasswordInput.value) {
                confirmPasswordInput.classList.add('invalid');
                confirmPasswordError.textContent = 'Passwords do not match.';
                confirmPasswordInput.setAttribute('aria-invalid', 'true');
                allValid = false;
            } else if (passwordInput.value.length > 0 && confirmPasswordInput.value.length > 0) {
                 clearValidation(confirmPasswordInput, confirmPasswordError);
            }

            // Validate terms and conditions checkbox
            if (!termsAgreeCheckbox.checked) {
                termsError.textContent = 'You must agree to the Terms of Service and Privacy Policy.';
                allValid = false;
            } else {
                termsError.textContent = '';
            }


            if (!allValid) {
                showFeedback('Please correct the errors in the form.', 'error');
                return;
            }

            const name = nameInput.value;
            const email = emailInput.value;
            // const password = passwordInput.value; // Already captured above for validation

            // Show loading state
            signupButtonText.textContent = 'Signing Up...';
            signupSpinner.classList.add('show');
            signupButton.disabled = true;
            signupButton.setAttribute('aria-busy', 'true');

            // Simulate API call
            setTimeout(() => {
                // In a real application, you'd send data to a server
                console.log('Attempting signup with:', { name, email, password });

                // Simulate successful signup
                showFeedback('Account created successfully! Redirecting to login...', 'success');

                setTimeout(() => {
                    window.location.href = 'atsogo-admin-login.html'; // Redirect to login page
                }, 1500);

                // Reset loading state (if not redirecting immediately)
                // signupButtonText.textContent = 'Sign Up';
                // signupSpinner.classList.remove('show');
                // signupButton.disabled = false;
                // signupButton.setAttribute('aria-busy', 'false');

            }, 2000); // Simulate network delay
        });

        // --- Keyboard Accessibility ---
        signupForm.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                // Prevent default form submission if any input is focused, let the button click handle it
                if (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'BUTTON') {
                    e.preventDefault();
                    signupButton.click();
                }
            }
        });

    </script>
</body>
</html>
